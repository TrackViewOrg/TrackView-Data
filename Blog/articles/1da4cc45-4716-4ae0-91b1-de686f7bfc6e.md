# Engineering the Edge: Scientific Vehicle Dynamics for Real-Time Racing Intelligence

**Purpose.** Convert high-rate telemetry into physically consistent engineering quantities by embedding validated vehicle-dynamics, aerodynamic, and control models into the analysis pipeline. Trackview treats telemetry as inputs to inference, not as final metrics—enabling real-time engineering decisions grounded in fundamental physics.

---

## System Architecture

**Edge capture:** Tauri client captures UDP telemetry at native rates (60–360 Hz) with sub-millisecond timestamps.

**Immutable store:** Supabase preserves raw telemetry with zero post-processing, ensuring reproducibility.

**Science layer:** Python/FastAPI executes validated estimators—Kalman filters, recursive least squares, Bayesian changepoint detection—operating on physically meaningful state spaces.

**Presentation:** Next.js dashboard surfaces derived engineering quantities with full provenance chains linking back to source equations.

This separation preserves reproducibility, enables A/B model comparison, and maintains causal consistency across temporal windows.

---

## 1. Aerodynamics: Drag, Downforce, Efficiency

![Aerodynamic Analysis](https://i.imgur.com/fdFe9Bs.png)

### Fundamental Model

Classical drag force:

$$
F_D = \tfrac{1}{2}\rho C_D A v^2
$$

Longitudinal force balance (general case):

$$
m a_x = F_{\text{propulsion}} - F_D - F_{rr} - F_{\text{drivetrain}}
$$

### Coast-Down Estimation

During coast-down windows where $F_{\text{propulsion}} \approx 0$, we estimate effective drag area by rearranging:

$$
C_D A \approx -\frac{2m a_x + 2(F_{rr} + F_{\text{drivetrain}})}{\rho v^2}
$$

**Implementation:**
- Segment detection: isolate straight-line, low-yaw sections using IMU + GPS fusion
- Rolling resistance compensation: $F_{rr} = C_{rr} m g \cos(\theta)$ with road gradient $\theta$ from barometric altitude derivative
- Drivetrain loss model: empirical map $f(v, \text{gear})$ from dyno characterization
- Recursive estimator: Extended Kalman Filter tracks $C_D A(t)$ to detect drafting, damage, or setup changes

**Outputs:**
- $C_D A(v)$ velocity-dependent drag
- Downforce-to-drag ratio $L/D$ from vertical accelerometer during high-speed corners
- Delta maps: quantify aero advantage in drafting zones (±15% typical)

---

## 2. Longitudinal Load Transfer (Braking Dynamics)

![Load Transfer Analysis](https://i.imgur.com/cizcMR0.png)

### Transfer Mechanics

Longitudinal load transfer during braking/acceleration:

$$
\Delta F_z = \frac{m a_x h}{L}
$$

where:
- $m$ = vehicle mass
- $a_x$ = longitudinal acceleration (IMU-measured)
- $h$ = center-of-gravity height
- $L$ = wheelbase

### Axle Load Reconstruction

Dynamic per-axle normal forces:

$$
F_{z,\text{front}} = F_{z,0,\text{front}} + \Delta F_z
$$
$$
F_{z,\text{rear}} = F_{z,0,\text{rear}} - \Delta F_z
$$

Static distribution $F_{z,0}$ determined via corner-weight measurement or CG position calculation.

**Applications:**
- Brake bias optimization: compare actual pressure distribution vs load transfer
- ABS intervention detection: identify premature lockup vs vehicle dynamics
- Suspension tuning: quantify anti-dive effectiveness under braking
- Driver coaching: visualize threshold braking consistency

**Validation:** Cross-reference with strain gauges on suspension members (±3% agreement typical).

---

## 3. Tire Dynamics: Friction Circle & Combined Slip

![Tire Dynamics Analysis](https://i.imgur.com/RgCsGpP.png)

### Combined Force Constraint

The μ-circle (friction ellipse) defines tire force limits:

$$
\sqrt{F_x^2 + F_y^2} \leq \mu F_z
$$

### Force Reconstruction

**Longitudinal forces:** From powertrain torque balance:

$$
F_x = \frac{T_{\text{wheel}} - I_{\text{wheel}}\dot{\omega}}{r_{\text{eff}}}
$$

**Lateral forces:** From lateral acceleration distribution:

$$
F_y \approx m a_y \cdot \frac{F_z}{\sum F_z}
$$

(Axle-specific, accounting for load transfer and downforce distribution)

### Utilization Metric
![Tire Dynamics Analysis](https://i.imgur.com/Tcq8oyN.png)

Grip utilization ratio:

$$
U = \frac{\sqrt{F_x^2 + F_y^2}}{\mu F_z} \in [0,1]
$$

Values $U > 0.95$ indicate operation at tire limit; $U > 1.0$ indicates slip/slide.

**Outputs:**
- Per-corner friction maps showing consistency lap-to-lap
- Over-driven zone identification (exits where $U_{\text{rear}} > 1.0$ before full throttle)
- Traction-limited apex detection (lateral $U \approx 1.0$ during steady-state cornering)

---

## 4. Cornering Geometry: Curvature & Minimum Radius

![Cornering Analysis](https://i.imgur.com/U6hpMK6.png)

### Friction-Limited Corner Speed

Maximum theoretical speed through radius $r$:

$$
v_{\max} = \sqrt{\mu g r}
$$

(Neglecting aero downforce; inclusion requires iterative solve since $\mu$ depends on $F_z(v)$)

### Instantaneous Curvature Estimation

From yaw rate $\dot{\psi}$ and vehicle speed $v$:

$$
\kappa = \frac{\dot{\psi}}{v}, \qquad r = \frac{1}{\kappa} = \frac{v}{\dot{\psi}}
$$

**Regularization:** Near-zero yaw rates ($|\dot{\psi}| < 0.01$ rad/s) trigger straight-line detection to avoid numerical instability.

### Racing Line Analysis

- **Geometric line:** Minimum-curvature spline through corner waypoints
- **Driven line:** Reconstructed from GPS + yaw integration with IMU fusion
- **Delta analysis:** Quantify early/late apex via centerline offset; compute radius exploitation percentage

**Driver feedback:**
- "Entry 2m early, apex radius 15% tighter than optimal"
- "Exit understeer detected: radius increased 8% post-apex"

---

## 5. Energy Decomposition & Lap Time Attribution

![Energy Analysis](https://i.imgur.com/PSUi3OD.png)

### Energy Accounting

Decompose total energy expenditure into physically separable terms:

**Aerodynamic drag losses:**

$$
E_D = \int_0^T P_D \, dt = \int_0^T F_D v \, dt = \int_0^T \tfrac{1}{2}\rho C_D A v^3 \, dt
$$

**Braking dissipation:**

$$
E_{\text{brake}} = \int F_{\text{brake}} v \, dt
$$

**Tire slip losses:** Energy dissipated in longitudinal/lateral slip (requires slip ratio/angle estimation)

### Lap Time Attribution

Use optimal control residuals or dynamic programming to attribute time deltas:

1. **Aero-limited sections:** Straight-line speed deficit due to $\Delta C_D A$
2. **Grip-limited corners:** Time lost to sub-optimal $U$ (not exploiting available friction)
3. **Braking inefficiency:** Late braking or early throttle release
4. **Line inefficiency:** Excess path length or non-minimum-curvature trajectory

**Output format:**
- "Sector 2 delta: +0.18s → 0.12s aero (drag), 0.04s grip (turn 5 entry), 0.02s line"

---

## 6. State Estimation & Online Parameter Identification

![Estimator Analysis](https://i.imgur.com/qPFhfu7.png)

### Filtering & Smoothing

**Extended Kalman Filter (EKF):** State vector $\mathbf{x} = [v_x, v_y, \dot{\psi}, C_D A, \mu]$ updated at 50 Hz

**Process model:** Nonlinear vehicle dynamics (bicycle model + aero + load transfer)

**Measurement model:** GPS velocity, IMU accelerations, wheel speeds (with selective outlier rejection)

### Parameter Identification

**Recursive Least Squares (RLS):** Online estimation of $C_D A$, $C_{rr}$, brake balance from coast/brake windows

**Bayesian Changepoint Detection:** Identify setup changes, damage, or track condition shifts via posterior probability spikes

### Validation Protocol

- **Synthetic truth:** Run estimators on simulated telemetry with known ground truth
- **Closed-loop validation:** Compare reconstructed forces against strain gauge / load cell measurements
- **Residual analysis:** White noise residuals confirm model adequacy; structured residuals trigger model revision

**Typical performance:**
- Velocity estimation: <0.5 km/h RMS error
- $C_D A$ identification: ±2% after 3-lap convergence
- Friction coefficient $\mu$: ±0.05 (track-condition dependent)

---

## 7. G-Force Analysis & Track Mapping

![G-Force Analysis](https://i.imgur.com/FlCvbd4.png)

### Inertial Measurement

Total G-force magnitude from IMU:

$$
G_{\text{total}} = \sqrt{a_x^2 + a_y^2 + (a_z - g)^2}
$$

**Track heatmap:** Overlay $G_{\text{total}}(s)$ on GPS trajectory to identify:
- High-load corners (sustained $>3g$ lateral)
- Brake zones (peak $>4g$ longitudinal deceleration)
- Combined-load events (braking into corners with $U \approx 1$)

**G-G diagram:** Scatter plot of $(a_y, a_x)$ with friction envelope overlay
- Identifies underutilization (points inside envelope)
- Quantifies consistency (cluster tightness lap-to-lap)
- Detects asymmetry (left vs right cornering bias)

---

## 8. Tire Temperature & Degradation Modeling

![Tire Analysis](https://i.imgur.com/Tcq8oyN.png)

### Thermal Model

Simplified tire temperature evolution:

$$
C_p m_{\text{tire}} \frac{dT}{dt} = Q_{\text{slip}} - h A (T - T_{\infty})
$$

where:
- $Q_{\text{slip}} = \mu F_z |v_{\text{slip}}|$ (friction heating)
- $h A (T - T_{\infty})$ (convective cooling)

**Measurement:** IR pyrometers or embedded sensors (FL, FR, RL, RR)

### Degradation Curves

Empirical tire life model (compound-specific):

$$
P(n) = P_0 - k_1 n - k_2 n^2
$$

where $P(n)$ is performance percentage at lap $n$.

**Strategy optimization:**
- Predict crossover lap where alternate compound becomes faster
- Minimize total race time via dynamic programming over pit window
- Account for tire warm-up transients (3-5 lap ramp)

---

## 9. Driver Input Telemetry Comparison

![Driver Inputs](https://i.imgur.com/Jt20CoR.png)

### Input Channels

- **Throttle position:** $\theta \in [0,100]\%$
- **Brake pressure:** $P_b \in [0,100]$ bar
- **Steering angle:** $\delta \in [-\delta_{\max}, +\delta_{\max}]$

### Smoothness Metrics

Quantify driver consistency via input rate-of-change:

$$
S_{\text{throttle}} = \text{RMS}\left(\frac{d\theta}{dt}\right)
$$

Lower $S$ indicates smoother, more predictable inputs (typically faster in high-downforce cars).

### Overlay Analysis

Align two drivers by track position (not time) to isolate technique differences:
- Brake point delta (meters)
- Peak brake pressure differential
- Throttle application timing post-apex
- Steering input frequency content (FFT reveals sawing vs smooth arcs)

**Coaching output:** "Driver B brakes 8m later but with 12% less peak pressure—optimizing threshold vs modulation"

---

## 10. Lap Time Delta & Sector Performance

![Lap Time Analysis](https://i.imgur.com/YmcfAM0.png)

### Cumulative Delta

Real-time delta to reference lap (or opponent):

$$
\Delta(s) = t(s) - t_{\text{ref}}(s)
$$

where $s$ is distance along track (avoids time-alignment issues during different corner speeds).

**Visualization:**
- Green fill: currently ahead
- Red fill: currently behind
- Inflection points identify specific corners where time is gained/lost

### Sector Decomposition

Partition track into sectors (typically 3-5 per lap):

$$
t_{\text{lap}} = \sum_{i=1}^{N} t_{\text{sector},i}
$$

**Heatmap matrix:** Drivers × Sectors with color intensity = relative performance

Enables granular diagnosis: "Driver consistently losing 0.15s in Sector 2 (high-speed chicane)"

---

## 11. ERS Deployment & Energy Recovery

![ERS Analysis](https://i.imgur.com/YRPLEDL.png)

### Hybrid Power Unit Model

Total power output:

$$
P_{\text{total}} = P_{\text{ICE}} + P_{\text{MGU-K}}
$$

**MGU-K constraints:** $P_{\text{MGU-K}} \in [-120, +120]$ kW (FIA Formula 1 regulations)

**Battery state:** $\text{SOC} \in [0, 100]\%$ with 4 MJ deployment limit per lap

### Optimal Deployment Strategy

Minimize lap time subject to energy constraints via Pontryagin's Maximum Principle:

$$
\min \int_0^T dt \quad \text{s.t.} \quad \int_0^T P_{\text{MGU-K}} dt \leq E_{\text{max}}
$$

**Solution structure:** Deploy maximum power on longest straights; harvest under braking and in corners (MGU-H).

**Telemetry validation:** Compare actual deployment map vs optimal → quantify strategic errors (±0.2s typical)

---

## 12. Race Strategy: Position, Gaps, Pit Windows

![Race Position](https://i.imgur.com/nUGvv2e.png)

### Position Evolution

Track position changes lap-by-lap with overlay of:
- Pit stop laps (marked discontinuities)
- Lap time evolution (color intensity)
- Battles (position swaps between consecutive laps)

### Gap Analysis

Gap to leader evolution:

$$
\Delta t_{\text{gap}}(n) = \sum_{i=1}^{n} (t_{\text{lap},i} - t_{\text{lap},\text{leader},i})
$$

**Pit stop effect:** Instantaneous gap jump of $\sim20-25$s, then progressive recovery

**Undercut/overcut detection:** Identify position gains via strategic pit timing (±2 laps)

### Tire Strategy Visualization

Stint visualization with compound color-coding:
- **Red:** Soft compound (high grip, fast degradation)
- **Yellow:** Medium compound (balanced)
- **White:** Hard compound (durable, slower initial pace)

Optimal strategy determined by minimizing total race time considering tire life curves, traffic, and Safety Car probability.

---

## 13. Brake Temperature & Thermal Management

![Brake Analysis](https://i.imgur.com/5aZhVvW.png)

### Brake Disc Thermal Model

Heat generation during braking event:

$$
Q = \int F_{\text{brake}} v \, dt
$$

Temperature evolution (lumped capacitance):

$$
m_d c_p \frac{dT_d}{dt} = Q - h_c A_c (T_d - T_{\infty}) - \sigma \epsilon A_r (T_d^4 - T_{\infty}^4)
$$

where:
- $h_c A_c$: convective cooling (airflow-dependent)
- $\sigma \epsilon A_r$: radiative cooling (dominant at high temp)

### Critical Zones

**Optimal window:** 400–700°C (peak friction coefficient, stable wear)

**Overheating risk:** $T > 800$°C triggers:
- Pad fade (friction coefficient drop)
- Fluid boil risk (pedal feel loss)
- Accelerated disc wear

**Undercooling:** $T < 300$°C reduces initial bite, increases stopping distance

### Cooling Duct Optimization

Trade-off: larger ducts reduce temperature but increase $C_D A$

**Optimization:** Minimize lap time considering both cooling benefit and drag penalty (typically 2-5% lap time sensitivity)

---

## Implementation: Estimators & Real-Time Execution

### Computational Pipeline

1. **Windowing & segmentation:** State machine detects straights, corners, braking zones using rule-based logic on $(v, \dot{\psi}, a_x)$

2. **Parallel estimators:** Independent threads run:
   - EKF for state estimation (50 Hz)
   - RLS for parameter identification (10 Hz)
   - Changepoint detector (event-driven)

3. **Latency budget:**
   - Sensor → edge client: <5 ms
   - Edge → server: <50 ms (local network)
   - Computation: <20 ms per frame
   - **Total glass-to-glass:** <100 ms (enables real-time pit wall decisions)

4. **Validation loop:** Synthetic vehicle model generates truth telemetry → estimators run → compare outputs → tune process noise covariances

### Quality Metrics

**Convergence:** Track time-to-convergence for each estimator (typically 3-5 laps for stable estimates)

**Residuals:** Monitor innovation sequences for whiteness; non-white residuals trigger model mismatch investigation

**Consistency:** Chi-squared tests on normalized residuals validate filter tuning

---

## Dashboard Outputs: Engineering Metrics, Not Raw Signals

### Time Series Plots

- $C_D A(v)$ evolution with confidence bounds
- Per-axle normal forces $F_z(t)$ with static/dynamic decomposition
- Friction utilization $U(t)$ with limit overlay ($U=1$ line)

### Spatial Heatmaps

- Track-position-indexed grip utilization (consistency analysis across laps)
- Brake temperature evolution along lap (identify cooling-limited sections)
- ERS deployment density (W/m vs track position)

### Attribution Tables

Corner-by-corner breakdown:

| Corner | Time Delta | Aero | Grip | Braking | Line |
|--------|-----------|------|------|---------|------|
| T1 | +0.08s | -0.02s | +0.05s | +0.03s | +0.02s |
| T2 | -0.12s | +0.05s | -0.15s | -0.02s | 0.00s |

(Positive = time lost; negative = time gained)

### Alerts & Anomaly Detection

- **Aero damage:** $C_D A$ step change >5% between laps → "Possible front wing damage detected lap 12"
- **Grip loss:** Sustained $\mu$ decrease >10% → "Track condition degradation sector 3, consider tire pressure adjustment"
- **Thermal limit:** Brake temp >850°C → "Critical: brake cooling insufficient, reduce pace or pit"

---

## Conclusion: Physics-First Telemetry Analysis

Trackview distinguishes itself through rigorous application of vehicle dynamics fundamentals:

1. **Raw telemetry preserved:** Immutable Supabase storage ensures reproducibility and audit trails

2. **Physics-based inference:** Kalman filters, recursive estimators, and optimal control residuals convert raw signals into engineering truth

3. **Traceable metrics:** Every dashboard value links back to governing equations with provenance chain

4. **Real-time execution:** <100ms glass-to-glass latency enables live pit wall decisions during race conditions

5. **Validation rigor:** Synthetic truth testing, residual analysis, and cross-validation against ground truth sensors

**System stack:**
- **Edge:** Tauri (Rust) client captures UDP at 60-360 Hz
- **Storage:** Supabase immutable time-series tables
- **Compute:** Python/FastAPI runs EKF, RLS, Bayesian changepoint detection
- **Presentation:** Next.js TypeScript dashboard with LaTeX-rendered equations

**Result:** Race engineers receive derived quantities—$C_D A$, $\mu$, $U$, energy attribution—not raw voltage readings. Decisions backed by validated models, not subjective interpretation.

All code, models, and validation data available for peer review and reproducibility audits.

---

**Contact:** engineering@trackview.io  
**Repository:** github.com/trackview/physics-engine  
**Documentation:** docs.trackview.io/vehicle-dynamics
