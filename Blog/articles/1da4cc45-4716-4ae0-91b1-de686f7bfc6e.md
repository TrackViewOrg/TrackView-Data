# Engineering the Edge: Scientific Vehicle Dynamics for Real-Time Racing Intelligence

![Trackview overview](https://i.imgur.com/FJcyeUt.png)

**Purpose.** Convert high-rate telemetry into physically consistent engineering quantities by embedding validated vehicle-dynamics, aerodynamic, and control models into the analysis pipeline. Trackview treats telemetry as inputs to inference, not as final metrics.

---

# System architecture (concise)

* **Edge capture:** Tauri client, UDP at native rates (60–360 Hz).
* **Immutable store:** Supabase (raw telemetry preserved).
* **Science layer:** Python / FastAPI runs estimators and models.
* **Presentation:** Next.js dashboard shows derived engineering quantities (not raw signals).

Separation preserves reproducibility, latency control, and testability.

---

# 1 — Aerodynamics: drag, downforce, efficiency

Classical drag model:

$$
F_D = \tfrac{1}{2},\rho,C_D A,v^2
$$

Longitudinal force balance (general):

$$
m,a_x = F_\text{propulsion} - F_D - F_{rr} - F_\text{drivetrain}
$$

During coast-down windows ($F_\text{propulsion}\approx0$) we estimate effective drag area $C_D A$ by regression:

$$
C_D A \approx -\frac{2,m,a_x + 2(F_{rr}+F_\text{drivetrain})}{\rho,v^2}
$$

Implementation notes (brief):

* Detect straight, low-yaw segments to isolate aero effects.
* Compensate for rolling resistance $F_{rr}\approx C_{rr} m g$ and estimated drivetrain losses.
* Use robust regression or a Kalman filter to track $C_D A$ over time.

Outputs: $C_D A(v)$, downforce-to-drag proxies, aero deltas (setup/damage/drafting).

---

# 2 — Longitudinal load transfer (braking)

Longitudinal load transfer formula:

$$
\Delta F_z = \frac{m,a_x,h}{L}
$$

Where $m$ = mass, $a_x$ = longitudinal acceleration, $h$ = CG height, $L$ = wheelbase.

Use IMU $a_x$ and known vehicle geometry to reconstruct per-axle normal force histories:

$$
F_{z,\text{front}} = F_{z,0,\text{front}} + \Delta F_z,\qquad
F_{z,\text{rear}} = F_{z,0,\text{rear}} - \Delta F_z
$$

Applications: separate driver-induced lockup from suspension/unloading effects, quantify braking efficiency independent of ABS/filtering.

---

# 3 — Tire friction / combined slip constraint

Combined longitudinal/lateral limit (μ-circle approximation):

$$
\sqrt{F_x^2 + F_y^2} \le \mu,F_z
$$

Procedure:

* Compute $F_x$ from longitudinal dynamics (drive/brake torque and inertia).
* Compute $F_y$ from lateral acceleration: $F_y \approx m,a_y$ (distributed per axle via load sharing model).
* Evaluate utilization ratio: $U=\dfrac{\sqrt{F_x^2+F_y^2}}{\mu F_z}$; $U\approx1$ indicates limit.

Outputs: friction utilization maps, over-driven zones, traction-limited exits.

---

# 4 — Cornering curvature and driven radius

Max corner speed (friction limited):

$$
v_{\max} = \sqrt{\mu,g,r}
$$

Reconstruct instantaneous curvature using yaw rate $\dot\psi$ and speed $v$:

$$
\kappa = \frac{\dot\psi}{v},\qquad r = \frac{1}{\kappa} = \frac{v}{\dot\psi}
$$

(Handle near-zero yaw rates with regularization.)

Compare driven radius to nominal track geometry to detect entry/exit errors: apex timing, late/early apex, radius exploitation.

---

# 5 — Energy / lap-time decomposition

Decompose lap time influence into physically meaningful components:

* Aerodynamic losses (drag power): $P_D = F_D,v$.
* Braking energy: $E_\text{brake} = \int F_\text{brake},v,dt$.
* Lateral friction utilization (time lost due to grip limits).
* Longitudinal inefficiencies (suboptimal throttle/brake sequencing).

Use per-segment attribution (dynamic programming / optimal control residuals) to answer: **which physical constraint dominated time loss**.

---

# Implementation and estimators (concise)

* **Windowing & segmentation:** detect straights, corners, coasts, and overlap zones deterministically.
* **Filters/estimators:** Kalman filters for state smoothing; robust (Huber) regression for parameter ID; Bayesian online changepoint detection for setup/damage detection.
* **Latency:** models run at configurable rates (e.g., 10–50 Hz) with priority on temporal coherence (no per-frame resampling that breaks causality).
* **Validation:** cross-validate inferred quantities against synthetic vehicle models and controlled track tests.

---

# Outputs surfaced in the UI

* Time series: $C_D A(v)$, axle normal forces, friction utilization $U(t)$.
* Maps: corner-by-corner physical attribution (aero vs grip vs braking).
* Heatmaps: utilization vs track position for consistency analysis.
* Alerts: significant parameter shifts (wing/debris/draft, suspected damage).

Images below show example visualizations used in the Next.js dashboard.

![Aerodynamic analysis visualization](https://i.imgur.com/DqicykM.png)
![Load transfer under braking](https://i.imgur.com/AFx8HmE.png)
![Cornering radius analysis](https://i.imgur.com/zJz5cNo.png)

---

# Conclusion — traceability and reproducibility

Trackview converts telemetry into engineering truth by:

1. Preserving raw data (ground truth).
2. Applying physically derived models and online estimators.
3. Presenting derived metrics that link directly to physical laws.

**Pipeline summary:** Tauri → Supabase → FastAPI (physics) → Next.js (derived visualizations).

All metrics are reproducible, unit-consistent, and traceable to the equations above.
